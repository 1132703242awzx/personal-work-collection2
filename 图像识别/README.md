# 人脸识别桌面应用程序

这是一个基于OpenCV的Windows桌面人脸识别应用程序，使用Visual Studio 2022开发。

## 功能特性

- 实时摄像头视频显示
- 人脸检测和识别
- 添加新的人脸到数据库
- 保存和加载训练数据
- 直观的用户界面

## 系统要求

- Windows 10/11
- Visual Studio 2022
- OpenCV 4.x
- 摄像头设备

## 安装和配置

### 1. 安装OpenCV

1. 从 [OpenCV官网](https://opencv.org/releases/) 下载OpenCV 4.x版本
2. 解压到某个目录，例如 `C:\opencv`
3. 设置环境变量：
   - 添加系统环境变量 `OPENCV_DIR` = `C:\opencv\build`
   - 在PATH中添加 `%OPENCV_DIR%\x64\vc16\bin`

### 2. 编译项目

1. 打开Visual Studio 2022
2. 打开解决方案文件 `图像识别.sln`
3. 选择 x64 平台（Debug或Release配置）
4. 编译项目

### 3. 运行应用程序

1. 确保摄像头已连接并可用
2. 运行编译后的可执行文件
3. 如果出现DLL缺失错误，请确保OpenCV的bin目录在PATH中

## 使用说明

### 基本操作

1. **启动摄像头**: 点击"开始摄像头"按钮启动视频捕获
2. **停止摄像头**: 点击"停止摄像头"按钮停止视频捕获

### 添加人脸

1. 确保摄像头已启动
2. 在"姓名"输入框中输入人员姓名
3. 将脸部对准摄像头，确保清晰可见
4. 点击"添加人脸"按钮
5. 系统会检测并保存人脸特征

### 识别人脸

1. 确保摄像头已启动且已有训练数据
2. 将要识别的人脸对准摄像头
3. 点击"识别人脸"按钮
4. 识别结果会显示在界面底部

### 数据管理

- **保存数据**: 点击"保存数据"按钮将训练数据保存为XML文件
- **加载数据**: 点击"加载数据"按钮从XML文件加载之前保存的训练数据

## 技术细节

### 核心组件

- **FaceRecognition类**: 封装了人脸检测和识别的核心功能
- **OpenCV库**: 提供计算机视觉算法支持
- **LBPH识别器**: 使用局部二进制模式直方图进行人脸识别
- **Haar级联分类器**: 用于人脸检测

### 算法说明

1. **人脸检测**: 使用Haar级联分类器检测图像中的人脸区域
2. **图像预处理**: 转换为灰度图、调整尺寸、直方图均衡化
3. **特征提取**: 使用LBPH算法提取人脸特征
4. **识别匹配**: 将待识别人脸与数据库中的特征进行比较

### 文件结构

```
图像识别/
├── 图像识别.cpp          # 主程序文件
├── 图像识别.h            # 主程序头文件
├── FaceRecognition.cpp   # 人脸识别实现
├── FaceRecognition.h     # 人脸识别头文件
├── Resource.h            # 资源定义
├── framework.h           # 框架头文件
└── 其他资源文件...
```

## 故障排除

### 常见问题

1. **编译错误**: 
   - 检查OpenCV环境变量是否正确设置
   - 确保项目配置为x64平台
   - 验证OpenCV版本兼容性

2. **运行时DLL错误**:
   - 确保OpenCV的bin目录在PATH环境变量中
   - 检查opencv_world4100.dll或opencv_world4100d.dll是否存在

3. **摄像头无法打开**:
   - 检查摄像头是否被其他程序占用
   - 验证摄像头驱动是否正常安装

4. **人脸检测效果不佳**:
   - 确保光线充足
   - 保持脸部正对摄像头
   - 避免遮挡物影响

### 性能优化建议

- 在Release模式下编译以获得更好的性能
- 调整摄像头分辨率以平衡质量和性能
- 定期清理训练数据库以提高识别准确率

## 许可证

本项目仅供学习和研究使用。使用OpenCV库需要遵循其相应的许可证协议。

## 联系信息

如有问题或建议，请联系开发者。
